while(!is.na(match("Centar", s.sf$name))){
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
}
library(sf)
s.sf <- st_read("gis_osm_places_free_1.shp")
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
source("C:/Users/user/Dropbox/My PC (DESKTOP-CDOPRMH)/Desktop/Faks/2.god/UZNL_projekt/Lokacije/kod.R")
library(sf)
s.sf <- st_read("gis_osm_places_free_1.shp")
for (i in 1:8){
s.sf <- s.sf[-c(match("Centar", s.sf$name))]
}
View(s.sf)
View(s.sf)
library(sf)
s.sf <- st_read("gis_osm_places_free_1.shp")
for (i in 1:8){
s.sf <- s.sf[-c(match("Centar", s.sf$name)), ]
}
source("C:/Users/user/Dropbox/My PC (DESKTOP-CDOPRMH)/Desktop/Faks/2.god/UZNL_projekt/Lokacije/kod.R")
# tu sam dosta tog pobrisala, možda će trebat nešto vratit haha
popup = paste0(
str_to_title(sp$fclass), ": ", sp$name,  "<br/>",
"Population: ", sp$population,  "<br/>")
map2 <- leaflet() %>%
addTiles() %>%
addMarkers(
data = sp,
label = lapply(popup, htmltools::HTML)
)
map2
for (col in range(ncol(df))) {
print(colnames(df)[col])
print(Moran.I(df[, col], dists.inv))
}
View(map2)
View(df)
View(df)
for (col in range(ncol(df))) {
print(col)
# print(colnames(df)[col])
# print(Moran.I(df[, col], dists.inv))
}
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
# print(colnames(df)[col])
# print(Moran.I(df[, col], dists.inv))
}
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
print(Moran.I(df[, col], dists.inv))
}
moran_coefficient <- data.frame()
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$col <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$col <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
source("C:/Users/user/Dropbox/My PC (DESKTOP-CDOPRMH)/Desktop/Faks/2.god/UZNL_projekt/Lokacije/kod.R")
moran_coefficient <- data.frame(c(colnames(df)))
View(moran_coefficient)
View(moran_coefficient)
moran_coefficient <- data.frame(c(colnames(df)))
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$col <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
View(moran_coefficient)
View(moran_coefficient)
moran_coefficient <- data.frame(colums(df))
moran_coefficient <- data.frame(columns(df))
moran_coefficient <- data.frame(matrix(nrow = 0, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
View(moran_coefficient)
View(moran_coefficient)
moran_coefficient <- data.frame(matrix(nrow = 0, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$col <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
moran_coefficient$14
moran_coefficient$'14'
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
print(col)
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$col <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
moran_coefficient$col
View(moran_coefficient)
View(moran_coefficient)
for (col in colnames(df)) {
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$'%col%' <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$as.String(col) <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient$as.string(col) <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
moran_coefficient[, 14]
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 24))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
# računjanje Moranovih koeficijenata
for (col in colnames(df)) {
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient[, col] <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
barplot(moran_coefficient[1, ])
moran_coefficient[1, ]
moran_coefficient[1, 2:25]
moran_coefficient[1, 2:24]
moran_coefficient <- data.frame(matrix(nrow = 4, ncol = 25))
colnames(moran_coefficient) <- colnames(df)
rownames(moran_coefficient) <- c('observed', 'expected', 'sd', 'p.value')
# računjanje Moranovih koeficijenata i spremanje u data.frame objekt
for (col in colnames(df)) {
moran <- Moran.I(df[, col], dists.inv)
moran_coefficient[, col] <- c(moran$observed, moran$expected, moran$sd, moran$p.value)
}
# vizualizacija koeficijenata u periodu od 24h
barplot(as.matrix(moran_coefficient[1, 2:25]))
View(moran_coefficient)
View(moran_coefficient)
barplot(as.matrix(moran_coefficient[1, 1:24]))
# vizualizacija koeficijenata u periodu od 24h
barplot(as.matrix(moran_coefficient[1, 1:25]))
# vizualizacija koeficijenata u periodu od 24h
barplot(as.matrix(moran_coefficient[1, 1:24]))
# vizualizacija koeficijenata u periodu od 24h
barplot(as.matrix(moran_coefficient[1, 1:24]),
main="Observed coefficient",
xlab="Hour",
ylab="Result",
border="red",
col="blue",
density=10)
barplot(as.matrix(moran_coefficient[1, 1:24]),
main="Observed coefficient",
xlab="Hour",
ylab="Result",
border="red",
col="blue",
density=10,
las=2)
barplot(as.matrix(abs(moran_coefficient[1, 1:24])),
main="Observed coefficient",
xlab="Hour",
ylab="abs(result)",
border="red",
col="blue",
density=10,
las=2)
barplot(as.matrix(abs(moran_coefficient[1, 1:24])),
main="Observed coefficient",
xlab="hour",
ylab="abs(result)",
col="blue",
density=10,
las=2)
barplot(as.matrix(abs(moran_coefficient[1, 1:24])),
main="Observed coefficient",
xlab="hour",
ylab="abs(result)",
col="blue",
density=10,
las=2,
cex = 0.65)
barplot(as.matrix(abs(moran_coefficient[1, 1:24])),
main="Observed coefficient",
xlab="hour",
ylab="abs(result)",
col="blue",
density=10,
)
# vizualizacija koeficijenata u periodu od 24h
barplot(as.matrix(abs(moran_coefficient[1, 1:24])),
main="Observed coefficient",
xlab="hour",
ylab="abs(result)",
col="blue",
las=2
)
rownames(moran_coefficient)[1]
for (i in range(4)){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col="blue",
las=2
)
}
colors <- c('gray', 'pink', 'blue', 'green')
for (i in range(4)){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2
)
}
for (i in 1:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2
)
}
barplot(as.matrix(moran_coefficient[1:2, 1:24]),
main="Observed vs expected",
xlab="hour",
ylab="result",
col=colors[1:2],
las=2)
barplot(as.matrix(moran_coefficient[1, 1:24], moran_coefficient[1, 1:24]-moran_coefficient[2, 1:24]),
main="Observed vs expected",
xlab="hour",
ylab="result",
col=colors[1:2],
las=2)
moran_coefficient[1, 1:24]-moran_coefficient[2, 1:24]
as.matrix(moran_coefficient[2, 1:24], moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24])
barplot(rbind(moran_coefficient[2, 1:24], moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24]),
main="Observed vs expected",
xlab="hour",
ylab="result",
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
legend("topleft",
c("Expected","Observed"),
fill = c("pink","gray")
),
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
legend("topleft",
c("Expected","Observed"),
fill = c("pink","gray")
),
beside = TRUE,
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[2, 1:24]-moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2)
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="Observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2,
legend("topleft",
c("Expected","Observed"),
fill = c("pink","gray"))
)
source("C:/Users/user/Dropbox/My PC (DESKTOP-CDOPRMH)/Desktop/Faks/2.god/UZNL_projekt/Lokacije/kod.R")
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
source("C:/Users/user/Dropbox/My PC (DESKTOP-CDOPRMH)/Desktop/Faks/2.god/UZNL_projekt/Lokacije/kod.R")
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
colors <- c('gray', 'pink', 'blue', 'green')
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
colors <- c('gray', 'pink', col=rgb(0.8,0.1,0.1,0.6), 'green')
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(0.8,0.3,0.6,0.6), rgb(0.2,0.4,0.6,0.6))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(0.8,0.6,0.7,0.6), rgb(0.2,0.4,0.6,0.6))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(0.8,0.3,0.6,0.6), rgb(0.8,0.6,0.7,0.1))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(0.8,0.3,0.6,0.6), rgb(0.8,0.6,0.7,0.9))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(0.8,0.3,0.6,0.6), rgb(0.9,0.6,0.7,0.9))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
colors <- c('gray', 'pink', col=rgb(1.0,0.7,0.5,0.6), rgb(0.9,0.6,0.7,0.9))
barplot(as.matrix(rbind(moran_coefficient[2, 1:24],
moran_coefficient[1, 1:24])),
main="observed vs expected",
xlab="hour",
ylab="result",
beside = TRUE,
col=colors[1:2],
las=2
)
legend("topleft",
c("Expected","Observed"),
fill = c("gray","pink"))
for (i in 3:4){
barplot(as.matrix(moran_coefficient[i, 1:24]),
main=rownames(moran_coefficient)[i],
xlab="hour",
ylab="result",
col=colors[i],
las=2)
}
